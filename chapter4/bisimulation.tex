Density operators represents equivalence classes over probabilistic mixtures of quantum states.
The implicit equivalence relation is $\{(\ket{\phi_i}, p_i)\}_i \cong \{(\ket{\phi_j}, p_j)\}$ iff $\sum_{i} p_i \ketbra{\phi_i}{\phi_i} = \sum_{j} p_j \ketbra{\phi_j}{\phi_j}$.
The physical justification of this equivalence is that different mixtures resulting in the same density operator cannot be distinguished since they behave the same.

The same equivalence relation is trivially extended to configurations, where the use of density operators for the quantum state allows a common representation of different configurations with an equivalent mixtures of quantum states. 
We extend here this equivalence relation to distributions of configurations.
Intuitively, we give rules for exchanging the probabilistic combination $\psum{p}$ in the state of some configurations for probabilistic combination of configurations, and vice-versa. 

\begin{definition}
	A \emph{quantum distribution} is an equivalence class $\mathbf{\Delta}$ of probabilistic distributions $\Delta$ over quantum configurations defined by the minimal equivalence relation such that:
	\begin{itemize}
		\item $(\overline{\confw{\rho, P}} \psum{p} \overline{\confw{\sigma, P}}) \equiv \overline{\confw{p \rho + (1-p)\sigma, P}}$; and
%		\item $(\overline{\confw{\rho \otimes \sigma, P}} \psum{p} \overline{\confw{\rho \otimes \sigma', Q}}) \equiv (\overline{\confw{\rho \otimes \delta, P}} \psum{p} \overline{\confw{\rho \otimes \delta', Q}})$ if $\Gamma, \Sigma \vdash P$, $\Gamma, \Sigma \vdash Q$, $\rho \in \hilbert_\Sigma$, and $p \sigma + (1 - p) \sigma' =  p \sigma + (1 - p) \sigma' = p \delta + (1 - p) \delta'$; and	
		\item $\Delta_i\ \equiv\ \Theta_i$, $i = 1, 2$, implies $\Delta_1 \psum{p} \Delta_2 \equiv\ \Theta_1 \psum{p} \Theta_2$.
	\end{itemize}
	We write $Q(Conf)$ for quantum distributions over configurations.
\end{definition}

\begin{definition}
	Given $\rel \subseteq Conf \times Conf$ be a relation over quantum configurations, let its quantum lifting be the minimal relation $\sqlift{\rel} \subseteq Q(Conf) \times Q(Conf)$ over quantum distributions such that $\Delta\ \slift{\rel}\ \Theta$ with $\Delta \in \mathbf{\Delta}$ and $\Theta \in \mathbf{\Theta}$ implies $\mathbf{\Delta}\ \sqlift{\rel}\ \mathbf{\Theta}$.
\end{definition}

%\begin{lemma}
%	For any $\rel$, $\slift{\rel}$ is left and right decomposable, i.e.,
%	\begin{itemize}
%		\item $(\Delta_1 \psum{p} \Delta_2) \slift{\rel} \Theta$ implies $\Theta = \Theta_1 \psum{p} \Theta_2$ and $\Delta_i \slift{\rel} \Theta_i$, $i = 1, 2$; and
%		\item $\Delta \slift{\rel} (\Theta_1 \psum{p} \Theta_2)$ implies $\Delta = \Delta_1 \psum{p} \Delta_2$ and $\Delta_i \slift{\rel} \Theta_i$, $i = 1, 2$.
%	\end{itemize}
%\end{lemma}
%\begin{proof}
%	We prove only the first point, the second being immediately derivable.
%\end{proof}

\begin{theorem}
	Let $\rel \subseteq Conf \times Conf$ be an equivalence relation over quantum configurations, then $\sqlift{\rel}$ is an equivalence relations over distributions of quantum configurations.
\end{theorem}
\begin{proof}
	Reflexivity and symmetry holds by definition given that $\rel$ is an equivalence relation.
	For transitivity, assume $\Delta \slift{\rel} \Theta \slift{\rel} \Xi$.
	{\color{red} decomponibilita' non vale con le definizioni che abbiamo dato...}
\end{proof}
{\color{red} TODO: capire come gestire il fatto che vogiamo che $\approx$ sia una relazione di equivalenza.}

%\begin{definition}
%	Given $\rel \subseteq Conf \times Conf$ be a relation over quantum configurations, let its quantum lifting be the minimal relation $\slift{\rel} \subseteq D(Conf) \times D(Conf)$ such that
%	\begin{itemize}
%		\item $\conf\ \rel\ \conf'$ implies $\overline{\conf}\ \slift{\rel}\ \overline{\conf'}$;
%		\item $\Delta_i\ \slift{\rel}\ \Theta_i$, $i = 1, 2$, implies $\Delta_1 \psum{p} \Delta_2 \slift{\rel}\ \Theta_1 \psum{p} \Theta_2$;
%		\item $(\overline{\confw{\rho, P}} \psum{p} \overline{\confw{\sigma, P}}) \slift{\rel} \overline{\confw{p \rho + (1-p)\sigma, P}}$;
%		\item $\overline{\confw{p \rho + (1-p)\sigma, P}} \slift{\rel} (\overline{\confw{\rho, P}} \psum{p} \overline{\confw{\sigma, P}})$.
%	\end{itemize} 
%\end{definition}

%\begin{theorem}
%	Let $\rel \subseteq Conf \times Conf$ be an equivalence relation over quantum configurations, $\slift{\rel}$ is an equivalence relations over distributions of quantum configurations.
%\end{theorem}
%\begin{proof}
%	Reflexivity and symmetry holds by definition given that $\rel$ is an equivalence relation.
%	For transitivity, assume $\Delta \slift{\rel} \Theta \slift{\rel} \Xi$.
%	{\color{red} decomponibilita' non vale con le definizioni che abbiamo dato...}
%\end{proof}


%In the following we write $qv(P)$ or $qv(\confw{\rho, P})$ for the set of free quantum variables in $P$, and $env(\confw{\rho, P})$ for $tr_{qv(P)}(\rho)$.

\begin{definition}[Barb]
	A \emph{barb} is a predicate $\downarrow_{c}$ over configurations where $\langle \rho, P \rangle \downarrow_{c}$ iff $P \equiv c!x + Q \parallel R$ for some $x$, and processes $Q$, $R$.
%	A \emph{barb} is a predicate $\downarrow_{p, c}$ over configurations where $\langle \rho, P \rangle \downarrow_{p, c}$ iff $tr(\rho) = p$ and
%	$P \equiv c!x + Q \parallel R$ for some $x$, and processes $Q$, $R$.
\end{definition}

%\begin{definition}[Barb Preserving Relation]
%	A relation $\rel \subseteq \conf \times \conf$ is \emph{barb preserving} if $\conf \rel \conf'$ implies that $\barb{p}{c}{\conf}$ iff $\barb{p}{c}{\conf'}$
%	for any $p \in [0,1]$ and any classical channel $c$.
%\end{definition}

%\begin{definition}[Probabilistic Barbed Bisimulation]
%	A symmetric relation $\rel_{\Gamma, \Sigma} \subseteq \conf \times \conf$ is \emph{probabilistic barbed bisimulation} if $\conf \rel \conf'$, with $\conf, \conf'$ well-typed under the context $\Gamma; \Sigma$, implies that 
%	\begin{itemize}
%		\item if $\conf \downarrow_{c}$ then $\conf' \downarrow_{c}$; and 
%		\item whenever $\conf \xrightarrow{\tau} \Delta$, there exists $\Delta'$ such that $\conf' \xrightarrow{\tau} \Delta'$ and $\Delta \slift{\rel} \Delta'$
%%		\item whenever $\conf' \xrightarrow{\tau} \Delta'$, there exists $\Delta$ such that $\conf \xrightarrow{\tau} \Delta$ and $\Delta \slift{\rel} \Delta'$
%	\end{itemize}
%\end{definition}

{\color{red} Non capisco dove, ma ci vuole: if $\confw{\rho, P} \approx \confw{\rho', P'}$ then $\confw{\sigma \otimes \rho, P} \approx \confw{\sigma \otimes \rho', P'}$}

\begin{definition}[Saturated Probabilistic Barbed Bisimilarity]
	A symmetric relation $\rel \subseteq \conf \times \conf$ is \emph{saturated probabilistic barbed bisimulation} if $\conf\ \rel\ \conf'$ implies that $\conf, \conf'$ are well-typed under a typing context $\Gamma; \Sigma$, and for any context $C[\_] \in Context_{\Gamma, \Sigma}$
	\begin{itemize}
		\item if $C[\conf] \downarrow_{c}$ then $C[\conf'] \downarrow_{c}$; and 
		\item whenever $C[\conf] \xrightarrow{\tau} \Delta \in \mathbf{\Delta}$, there exists $\Delta' \in \mathbf{\Delta'}$ such that $C[\conf'] \xrightarrow{\tau} \Delta'$ and $\mathbf{\Delta}\ \sqlift{\rel}\ \mathbf{\Delta'}$
		%		\item whenever $\conf' \xrightarrow{\tau} \Delta'$, there exists $\Delta$ such that $\conf \xrightarrow{\tau} \Delta$ and $\Delta \slift{\rel} \Delta'$
	\end{itemize}
	Let \emph{saturated probabilistic barbed bisimilarity} $\approx_{SPB}$ be the largest saturated probabilistic barbed bisimulation.
\end{definition}

\note{
Comunque, anche usando la freccia $\rightarrow_q$, mi sa che comunque serve una nozione di lifting quantum della relazione. Infatti, supponiamo una semplice bisimulazione LS con freccia quantum: $\conf \rel 	\conf'$ implica \begin{itemize}
\item $\conf\downarrow_c$ implica $\conf'\downarrow_c$
\item $B[\conf] \rightarrow_q \Delta$ implica $B[\conf'] \rightarrow_q \Delta'$ e $\Delta \lrel \Delta'$ (solo lifting prob.)
\end{itemize}
 le configurazioni $ \conf = \confw{\proj{\beta}, M_{01}[q \rhd x].disc(q)  } $ e 
 $\conf' = \confw{\proj{\beta}, M_\pm[q \rhd x].disc(q)}$ non sono bisimili. 
 Infatti, è vero che $\conf \rightarrow_q \confw{\proj{00} \psum{\frac{1}{2}} \proj{11}, disc(q)}$, e allora $\conf'$ ha la transizione $\conf' \rightarrow_q \confw{\proj{++} \psum{\frac{1}{2}} \proj{--}, disc(q)}$ e possiamo dimostrare che sono uguali, in qualche modo. Ma $\conf$ ha anche la transizione $\conf \rightarrow_q \confw{\proj{00}, disc(q)} \psum{\frac{1}{2}} \confw{\proj{00}, disc(q)}$, che va in una distribuzione, e a questo punto la relazione liftata $\lrel$ vuole uan distribuzione di configurazioni  bisimili punto a punto.

Quindi abbiamo comunque bisogno di una relazione liftata $\sqlift{\rel}$, cioè una relazione fra classi di distribuzioni, che però rende le bisimulazioni non chiuse per composizione.
}

By writing $\sop \in TSO(\hilbert_{\Sigma})$, we mean that $\sop(\rho) = \sum_{i \in I} (I_{\overline{\Sigma}} \otimes A_i) \rho (I_{\overline{\Sigma}} \otimes A_i)^{\dagger}$.

%{\color{red} Per la misura come non-trace preserving, che noi usiamo nella regola di misura della semantica, abbiamo la stessa proprieta', in particolare, rispetto alla versione trace-preserving avremmo semplicemente che la sommatoria sara' composta da meno elementi.}

\begin{lemma}\label{lemma:sop}
	For any pair of configurations $\conf, \conf'$ well-typed under $\Gamma; \Sigma$, and for any $\sop \in TSO(\hilbert_{\overline{\Sigma}})$,
	$\conf \rightarrow \Delta$ iff $\sop(\conf) \rightarrow \sop(\Delta)$.
\end{lemma}
\begin{proof}
	The only non trivial rules are {\scshape SemQOp} and {\scshape SemQMeas}.
	Assume without loss of generality that $env(\conf) \in \hilbert_{\Sigma \otimes \overline{\Sigma}}$.
	By {\scshape SemQOp}, $\conf = \langle \rho, \mathcal{E}(\widetilde{x}) . P \rangle \longrightarrow \langle \mathcal{E}_{\widetilde{x}}(\rho), P \rangle = \Delta$.
	The type system ensures that $\tilde{x} \subseteq \Sigma$.
	We assume without loss of generality that $\tilde{x} = \Sigma$.
	We can also apply {\scshape SemQOp} as follows, $\sop(\conf) = \langle \sop(\rho), \mathcal{E}(\widetilde{x}) . P \rangle  \longrightarrow \langle \mathcal{E}_{\widetilde{x}}(\sop(\rho)), P \rangle$.
	We need to prove that $\langle \mathcal{E}_{\widetilde{x}}(\sop(\rho)), P \rangle = \langle \sop(\mathcal{E}_{\widetilde{x}}(\rho)), P \rangle = \sop(\Delta)$, i.e., that $\sop_{\widetilde{x}}(\sop(\rho)) = \sop(\sop_{\widetilde{x}}(\rho))$.
	By definition, $\sop_{\widetilde{x}}(\rho) = \sum_{i = 1}^{n} (I_{\Sigma} \otimes A_i) \rho (I_{\Sigma} \otimes A_i)^{\dagger}$, and $\sop(\rho) = \sum_{j = 1}^{m} (B_j \otimes I_{\overline{\Sigma}}) \rho (B_j \otimes I_{\overline{\Sigma}})^{\dagger}$.

	By linearity 
	\begin{align*}
	&\sop_{\widetilde{x}}(\sop(\rho)) =\\ 
	&\sum_{i = 1}^{n} (I_{\Sigma} \otimes A_i) (\sum_{j = 1}^{m} (B_j \otimes I_{\overline{\Sigma}}) \rho (B_j \otimes I_{\overline{\Sigma}})^{\dagger}) (I_{\Sigma} \otimes A_i)^{\dagger} =\\
	&\sum_{i = 1}^{n} \sum_{j = 1}^{m} (I_{\Sigma} \otimes A_i) (B_j \otimes I_{\overline{\Sigma}}) \rho (B_j \otimes I_{\overline{\Sigma}})^{\dagger} (I_{\Sigma} \otimes A_i)^{\dagger},
	\end{align*}
	and
	\begin{align*}
	&\sop(\sop_{\widetilde{x}}(\rho)) =\\
	&\sum_{j = 1}^{m} (B_j \otimes I_{\overline{\Sigma}}) (\sum_{i = 1}^{n} (I_{\Sigma} \otimes A_i) \rho (I_{\Sigma} \otimes A_i)^{\dagger}) (B_j \otimes I_{\overline{\Sigma}})^{\dagger} =\\
	&\sum_{i = 1}^{n} \sum_{j = 1}^{m} (B_j \otimes I_{\overline{\Sigma}}) (I_{\Sigma} \otimes A_i) \rho (I_{\Sigma} \otimes A_i)^{\dagger} (B_j \otimes I_{\overline{\Sigma}})^{\dagger}.
	\end{align*}
	Thanks to conjugate properties, it is thus sufficient to show that
	\[
	(B_{p\times p} \otimes I_{q\times q}) (I_{p\times p} \otimes A_{q\times q}) = (I_{p\times p} \otimes A_{q\times q}) (B_{p\times p} \otimes I_{q\times q}).
	\]
	
	This is easily proven thanks to the mixed product property of the Kronecker product, telling us that 
	\[ (A \otimes B)(C \otimes D) = (AC)\otimes(BD)
	\]
	so in our case, we have 
	\[
	(B_{p\times p} \otimes I_{q\times q}) (I_{p\times p} \otimes A_{q\times q}) = B_{p\times p} \otimes A_{q \times q} = (I_{p\times p} \otimes A_{q\times q}) (B_{p\times p} \otimes I_{q\times q})
	\]	
	
	
%	Take
%	\begin{align*}
%		&(B_{p\times p} \otimes I_{q\times q}) (I_{p\times p} \otimes A_{q\times q}) =\\
%		&\left(\begin{array}{c c c}
%			B_{1,1} I_{q\times q} & \dots & B_{1,p} I_{q\times q}\\
%			\dots & & \dots\\
% 			B_{p,1} I_{q\times q} & \dots & B_{p,p} I_{q\times q}\\
%	\end{array}\right)
%\left(
%\begin{array}{c c c c c }
%	A_{q\times q} & \bigzero & \bigzero & \dots & \bigzero \\
%	\bigzero & A_{q\times q} & \bigzero & \dots & \bigzero \\
%	\dots & \dots & \dots & \dots & \dots \\
%	\bigzero & \dots & \dots & \dots & A_{q\times q} \\
%\end{array}
%\right),
%\end{align*}
%and take the element at column $i$, row $j$.
%Note that it is $B_{i,j} I_{q\times q} A_{q\times q}$.
%Take then
%\begin{align*}
%	&(I_{p\times p} \otimes A_{q\times q}) (B_{p\times p} \otimes I_{q\times q}) =\\
%	&\left(
%	\begin{array}{c c c c c }
%		A_{q\times q} & \bigzero & \bigzero & \dots & \bigzero \\
%		\bigzero & A_{q\times q} & \bigzero & \dots & \bigzero \\
%		\dots & \dots & \dots & \dots & \dots \\
%		\bigzero & \dots & \dots & \dots & A_{q\times q} \\
%	\end{array}
%	\right)
%	\left(\begin{array}{c c c}
%		B_{1,1} I_{q\times q} & \dots & B_{1,p} I_{q\times q}\\
%		\dots & & \dots\\
%		B_{p,1} I_{q\times q} & \dots & B_{p,p} I_{q\times q}\\
%	\end{array}\right),
%\end{align*}
%and take the element at column $i$, row $j$.
%Note that it is $A_{q\times q} B_{i,j} I_{q\times q}$.
%The thesis follow by linearity and commutativity of the identity.

%\begin{align*}
%&\left(
%\begin{array}{c c c c }
%	B_{1,1} I_{q\times q} A_{q\times q} & B_{1,2} I_{q\times q} A_{q\times q} & \dots & B_{1,p} I_{q\times q} A_{q\times q} \\
%	B_{2,1} I_{q\times q} A_{q\times q} & B_{2,2} I_{q\times q} A_{q\times q} & \dots & B_{2,p} I_{q\times q} A_{q\times q} \\
%	\dots & \dots & \dots & \dots\\
%	B_{p,1} I_{q\times q} A_{q\times q} & B_{p,2} I_{q\times q} A_{q\times q} & \dots & B_{p,p} I_{q\times q} A_{q\times q} \\
%\end{array}
%\right) = \\
%&\left(
%\begin{array}{c c c c }
%	A_{q\times q} B_{1,1} I_{q\times q} & A_{q\times q} B_{1,2} I_{q\times q} & \dots & A_{q\times q} B_{1,p} I_{q\times q} \\
%	A_{q\times q} B_{2,1} I_{q\times q} & A_{q\times q} B_{2,2} I_{q\times q} & \dots & A_{q\times q} B_{2,p} I_{q\times q} \\
%	\dots & \dots & \dots & \dots\\
%	A_{q\times q} B_{p,1} I_{q\times q} & A_{q\times q} B_{p,2} I_{q\times q} & \dots & A_{q\times q} B_{p,p} I_{q\times q} \\
%\end{array}
%\right) = \\
%\end{align*}

The proof for rule {\scshape SemQMeas} is the same, considering every $m \in \{0, \dots, 2^{\widetilde{x}}\}$ separately.
\end{proof}


\begin{theorem}
%	For any pair of configurations $\conf, \conf'$ well-typed under $\Gamma; \Sigma$, 
%	$\conf \approx_{SPB} \conf'$ implies that for any $\sop \in TSO(\hilbert_{\overline{\Sigma}})$, $\sop (\conf)\ \approx_{SPB}\ \sop (\conf')$.
	For any pair of configurations $\conf, \conf'$ well-typed under $\Gamma; \Sigma$, 
	$\conf \approx_{SPB} \conf'$ implies
	\begin{enumerate}
		{\item for any $\sop \in TSO(\hilbert_{\overline{\Sigma}})$, $\sop (\conf)\ \approx_{SPB}\ \sop (\conf')$; and \label{point:thmchinese1}}
		{\item $tr_{\Sigma}(\conf) = tr_{\Sigma}(\conf')$. \label{point:thmchinese2}}
	\end{enumerate}
\end{theorem}
\begin{proof}
	The proof of point \ref{point:thmchinese1} follows by transitivity and Lemma~\ref{lemma:sop}.
	\[
	 \sop (\conf)\ \approx_{SPB}\ \conf\ \approx_{SPB}\ \conf'\ \approx_{SPB}\ \sop (\conf') 
	\]
	For point \ref{point:thmchinese2} we proceed by refutation.
	Assume $\conf \approx_{SPB} \conf'$ and $tr_{\Sigma}(\conf) \neq tr_{\Sigma}(\conf')$.
	Take $env(\conf), env(\conf') \in \hilbert_{\{ q \} \otimes \Sigma}$ with $env(\conf) = \ket{0} \otimes \ket{\phi}$ and $env(\conf') = \ket{1} \otimes \ket{\phi'}$.
	Consider the context $B[\_] = M[q \triangleright x] . \textbf{ if } x = 0 \textbf{ then } c!q \textbf{ else } free(q) \parallel [\_]$.
	It is clear that $B[\conf] \not\approx_{SPB} B[\conf']$. Contradiction.
\end{proof}

\begin{example}
	Consider the following, wrong definition of quantum teleportation:
	\begin{align*}
		\proc{A} &\Coloneqq \text{in}_a?x.\text{CNOT}(q_0, x).\text{H}(q_0).M(x,q_0 \rhd n).(\text{m}_a!n \parallel out_{a_1}! q_0 \parallel out_{a_2}! x )\\
    \proc{B} &\Coloneqq \text{in}_b?x.\text{m}_a?n.
       \\ & \ite{n = 0}{\sigma_0(x).\text{out}_b!x\\&\quad}
      {\ite{n = 1}{\sigma_1(x).\text{out}_b!x\\&\qquad}
          {\ite{n = 2}{\sigma_2(x).\text{out}_b!x}{\sigma_3(x).\text{out}_b!x}}
      } \\
		\proc{S} &\Coloneqq \text{H}(q_1).\text{CNOT}(q_1, q_2).(\text{in}_a!q_1 \parallel \text{in}_b!q_2) \\
		\proc{Tel} &\Coloneqq (A \parallel B \parallel S) \setminus \Set{\text{in}_a, \text{in}_b, \text{m}_a } \\
		\proc{TelSpec} &\Coloneqq \text{SWAP}(q_0,q_2).(\text{out}_b!q_2 \parallel out_{a_1}! q_0 \parallel out_{a_2}! q_1)
	\end{align*}
	We have that $\proc{Tel} \not\approx_{SPB} \proc{TelSpec}$.
	Consider indeed a context:
  \[ B[\blank] = out_{a_1} ? x . M[x \rhd y] . \ite{y = 1}{c!y}{nil}. \]
\end{example}

An established notion of behavioural equivalence between quantum processes is the Deng-Feng bisimilarity, here we focus on the strong version of it.
\begin{definition}[Deng-Feng Bisimilarity]
	A symmetric relation $\rel \subseteq \conf \times \conf$ is \emph{Deng-Feng bisimulation} if $\conf\ \rel\ \conf'$ implies that $\conf, \conf'$ are well-typed under a typing context $\Gamma; \Sigma$, and for any context $C[\blank] \in Context_{\Gamma, \Sigma}$
	\begin{itemize}
		\item $tr_{\Sigma}(\conf) = tr_{\Sigma}(\conf')$;
		\item if $C[\sop(\conf)] \downarrow_{c}$ then $C[\sop(\conf')] \downarrow_{c}$; and
		\item whenever $C[\sop(\conf)] \xrightarrow{\tau} \Delta$, there exists $\Delta'$ such that $C[\sop(\conf')] \xrightarrow{\tau} \Delta'$ and $\Delta \slift{\rel} \Delta'$
	\end{itemize}
	Let \emph{Deng-Feng bisimilarity} $\approx_{DF}$ be the largest saturated probabilistic barbed bisimulation.
\end{definition}

\begin{theorem}
	For any pair of configurations $\conf, \conf'$, $\conf \approx_{DF} \conf'$ iff $\conf \approx_{SPB} \conf'$.
\end{theorem}


From Davidson we expect that $\confw{\beta, M_{0,1}[q_0 \triangleright x] . c ! q_0 \parallel discard(q_1)} \approx_{SPB} \confw{\beta, M_{0,1}[q_0 \triangleright x] . c ! q_0 \parallel discard(q_1)}$.

{\color{red} se li invio entrambi?}
%The converse does not hold.
%This is because $tr_{\Sigma}(\conf) = tr_{\Sigma}(\conf')$ is strictly stronger than our closure on contexts, given that it requires the state of qbits to be equivalent

%\begin{definition}[FD-barbed congruence]
%	A probabilistic barbed bisimulation $\rel \subseteq \conf \times \conf$ is a \emph{FD-barbed congruence} if $\conf \rel \conf'$ implies that 
%	\begin{itemize}
%		\item $(\conf \parallel P) \rel (\conf' \parallel P)$ for any process $P$ with $qv(P)$ disjoint from $qv(\conf) \cup qv(\conf')$ 
%		\item $\sop (\conf) \rel \sop (\conf')$ for any $\sop \in TSO(\hilbert_{\overline{qv(\conf)}})$
%	\end{itemize}
%\end{definition}
%
%The following congruence was proposed in~\cite{Deng:2012} by Feng and Deng.
%\begin{definition}
%	Let FD-congruence is the largest relation $\approx_{FD} \subseteq \conf \times \conf$ which is barb preserving, reduction closed, compositional and such that if $\conf \rel \conf'$ implies $qv(\conf) = qv(\conf')$ and $env(\conf) = env(\conf')$.
%\end{definition}
%
%\begin{definition}[open FD-simulation and bisimulation]
%	A relation $\rel \subseteq \conf \times \conf$ is an \emph{open FD-simulation} if $\conf \rel \conf'$ implies that $qv(\conf) = qv(\conf')$, $env(\conf) = env(\conf')$ and, for all $\sop \in TSO(\hilbert_{\overline{qv(\conf)}})$,
%	\begin{itemize}
%		\item whenever $\sop(\conf) \xrightarrow{\alpha} \Delta$, there is some $\Delta'$ such that $\sop(\conf') \xrightarrow{\alpha} \Delta'$ and $\Delta \slift{\rel} \Delta'$.
%	\end{itemize}
%
%	A relation $\rel \subseteq \conf \times \conf$ is an \emph{open FD-bisimulation} iff $\rel$ and $\rel^{-1}$ are open FD-simulations.
%	
%	Let FD-open bisimilarity $\approx_{oFD}$ be the largest FD-open bisimulation. 
%\end{definition}
%
%The following theorem is proved in~\cite{Deng:2012}.
%\begin{theorem}
%	$\conf \approx_{FD} \conf'$ iff $\conf \approx_{oFD} \conf'$
%\end{theorem}

%\begin{definition}[Barbed Simulation]
%  A relation $\mathcal{R}_{\Gamma, \Sigma}$ is called a \emph{barbed simulation} if it is closed under the $\boxplus$-operator and for each
%  pair of configurations $\langle \rho, P \rangle$, $\langle \sigma, Q \rangle$, well-typed under the context $\Gamma; \Sigma$, it holds that:
%  \begin{enumerate}
%    \item if $\langle \rho, P \rangle \longrightarrow \boxplus_{i \in I} \langle \rho_i, P_i \rangle$, then
%      $\langle \sigma, Q \rangle \longrightarrow \boxplus_{j \in J} \langle \sigma_j, Q_j \rangle$, and
%      $\forall i \in I \ldotp \exists j \in J \ldotp \langle \rho_i, P_i \rangle \mathcal{R}_{\Gamma, \Sigma} \langle \sigma_j, Q_j \rangle $;
%    \item if $\langle \rho, P \rangle \downarrow_{p, c}, then \langle \sigma, Q \rangle \downarrow_{p, c}$.
%  \end{enumerate}
%\end{definition}
% 
%\begin{definition}[Barbed Bisimulation]
%  A relation $\mathcal{R}_{\Gamma, \Sigma}$ is called a \emph{barbed bisimulation} if it's symmetric, closed under the $\boxplus$-operator and for each
%  pair of configurations $\langle \rho, P \rangle$, $\langle \sigma, Q \rangle$, well-typed under the context $\Gamma, \Sigma$ it holds that:
%  \begin{enumerate}
%    \item if $\langle \sigma, \rho \rangle \longrightarrow \boxplus_{i \in I} \langle \rho_i, P_i \rangle$, then
%      $\langle \sigma, q \rangle \longrightarrow \boxplus_{i \in I} \langle \sigma_i, Q_i \rangle$, and
%      $\forall i \in I \ldotp \langle \rho_i, P_i \rangle \mathcal{R}_{\Gamma, \Sigma} \langle \sigma_i, Q_i \rangle$;
%    \item if $\langle \rho, P \rangle \downarrow_{p, c}, then \langle \sigma, Q \rangle \downarrow_{p, c}$.
%  \end{enumerate}
%\end{definition}
